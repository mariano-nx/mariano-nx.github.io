<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title> Mina Demooo </title>
		<script type="text/javascript" charset="utf-8">
  (function (g, e, n, es, ys) {
    g['_genesysJs'] = e;
    g[e] = g[e] || function () {
      (g[e].q = g[e].q || []).push(arguments)
    };
    g[e].t = 1 * new Date();
    g[e].c = es;
    ys = document.createElement('script'); ys.async = 1; ys.src = n; ys.charset = 'utf-8'; document.head.appendChild(ys);
  })(window, 'Genesys', 'https://apps.mypurecloud.com/genesys-bootstrap/genesys.min.js', {
    environment: 'use1',
    deploymentId: '1250be9f-31f5-4095-ad48-1100e92ee949'
  });
   
   let connected = false;
	Genesys('subscribe', 'MessagingService.messagesReceived', function({ data }) {

 
		data.messages.forEach(function(message) {  

		  if(!connected){
		  if (message.direction === 'Outbound' ) {
			let agent = message.originatingEntity;
				if (agent === 'Human') {
				 connected=true; //add push to google tag here
				 console.log("agent entered the chat");
				}	  
			  }
			}  
		

		  if (message.type === 'Event' && message.events) {
			let disconnectEvent = message.events.find(e => e.eventType === 'Presence' && e.presence.type === 'Disconnect');			

			if (disconnectEvent) {
				//revert back connected to false since they are disconnected
				console.log("disconnected");
				connected=false;
		
			  }
			  }
			  }
			  )
			  }
			  );

</script>


	</head>
	<body>

	</body>

</html>
